<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Racket notes | </title>
  <link rel = 'canonical' href = 'https://www.carldelfin.com/posts/2020-02-29-racket/'>
  <meta name="description" content="My name is Slim Shady.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Racket notes" />
<meta property="og:description" content="Basic #lang racket (provide (all-defined-out)) ;this is a comment (define s &#34;hello&#34;) (define x 3) (define y (&#43; x 2)) (define cube1 (lambda (x) (* x (* x x)))) (define cube2 (lambda (x) (* x x x))) (define (cube3 x) (* x x x)) (define (pow1 x y) (if (=y 0) 1 (* x (pow1 x (- y 1))))) ; currying (define pow2 (lambda (x) (lambda (y) (pow1 x y)))) List  Empty list: null  () doesn&quot;t work for null but &#39;() does   build a list: (list e1 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.carldelfin.com/posts/2020-02-29-racket/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-29T09:00:00+00:00" />
<meta property="article:modified_time" content="2020-02-29T09:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Racket notes"/>
<meta name="twitter:description" content="Basic #lang racket (provide (all-defined-out)) ;this is a comment (define s &#34;hello&#34;) (define x 3) (define y (&#43; x 2)) (define cube1 (lambda (x) (* x (* x x)))) (define cube2 (lambda (x) (* x x x))) (define (cube3 x) (* x x x)) (define (pow1 x y) (if (=y 0) 1 (* x (pow1 x (- y 1))))) ; currying (define pow2 (lambda (x) (lambda (y) (pow1 x y)))) List  Empty list: null  () doesn&quot;t work for null but &#39;() does   build a list: (list e1 ."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://www.carldelfin.com/css/styles.6783045861a88c3c512c75c0af54fa1a0fc8758602f5e55b603ed3a95f89bc6ae822eacb3b7655abf3b9964cf4a0c4f4ddf50a95d1f20502b9602d1b19534834.css" integrity="sha512-Z4MEWGGojDxRLHXAr1T6Gg/IdYYC9eVbYD7TqV&#43;JvGroIurLO3ZVq/O5lkz0oMT03fUKldHyBQK5YC0bGVNINA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://www.carldelfin.com/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://www.carldelfin.com/posts/2019-12-30-standardml-notes/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://www.carldelfin.com/posts/2020-04-29-subtyping/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&text=Racket%20notes" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&is_video=false&description=Racket%20notes" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Racket%20notes&body=Check out this article: https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&name=Racket%20notes&description=Basic%20%23lang%20racket%20%28provide%20%28all-defined-out%29%29%20%3bthis%20is%20a%20comment%20%28define%20s%20%26%2334%3bhello%26%2334%3b%29%20%28define%20x%203%29%20%28define%20y%20%28%2b%20x%202%29%29%20%28define%20cube1%20%28lambda%20%28x%29%20%28%2a%20x%20%28%2a%20x%20x%29%29%29%29%20%28define%20cube2%20%28lambda%20%28x%29%20%28%2a%20x%20x%20x%29%29%29%20%28define%20%28cube3%20x%29%20%28%2a%20x%20x%20x%29%29%20%28define%20%28pow1%20x%20y%29%20%28if%20%28%3dy%200%29%201%20%28%2a%20x%20%28pow1%20x%20%28-%20y%201%29%29%29%29%29%20%3b%20currying%20%28define%20pow2%20%28lambda%20%28x%29%20%28lambda%20%28y%29%20%28pow1%20x%20y%29%29%29%29%20List%20%20Empty%20list%3a%20null%20%20%28%29%20doesn%26quot%3bt%20work%20for%20null%20but%20%27%28%29%20does%20%20%20build%20a%20list%3a%20%28list%20e1%20." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&t=Racket%20notes" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basic">Basic</a>
      <ul>
        <li><a href="#list">List</a></li>
        <li><a href="#syntax">Syntax</a></li>
        <li><a href="#dynamic-typing">Dynamic typing</a></li>
        <li><a href="#cond">Cond</a></li>
        <li><a href="#what-is-true">What is true?</a></li>
        <li><a href="#local-bindings">Local bindings</a>
          <ul>
            <li><a href="#letletletrec">let/let*/letrec</a></li>
          </ul>
        </li>
        <li><a href="#set">set!</a></li>
        <li><a href="#consmcons">cons/mcons</a></li>
      </ul>
    </li>
    <li><a href="#delayed-evaluation-and-thunk">Delayed Evaluation and Thunk</a></li>
    <li><a href="#lazy-evaluationcall-by-needpromises">Lazy-evaluation/Call-by-need/Promises</a></li>
    <li><a href="#streams">Streams</a></li>
    <li><a href="#memoization-not-memorization">Memoization (Not Memorization)</a></li>
    <li><a href="#macros">Macros</a>
      <ul>
        <li><a href="#syntax-1">Syntax</a></li>
        <li><a href="#hygiene">Hygiene</a></li>
      </ul>
    </li>
    <li><a href="#recursive-datatypes-via-racketss-struct">Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Racket notes
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-02-29 09:00:00 &#43;0000 UTC" itemprop="datePublished">2020-02-29</time>
          
        </div>
        
        
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="basic">Basic</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#007020;font-weight:bold">#lang </span><span style="color:#0e84b5;font-weight:bold">racket</span>
(<span style="color:#007020;font-weight:bold">provide</span> (<span style="color:#007020;font-weight:bold">all-defined-out</span>))

<span style="color:#60a0b0;font-style:italic">;this is a comment</span>

(<span style="color:#007020;font-weight:bold">define</span> s <span style="color:#4070a0">&#34;hello&#34;</span>)

(<span style="color:#007020;font-weight:bold">define</span> x <span style="color:#40a070">3</span>)
(<span style="color:#007020;font-weight:bold">define</span> y (<span style="color:#007020">+</span> x <span style="color:#40a070">2</span>))

(<span style="color:#007020;font-weight:bold">define</span> cube1
  (<span style="color:#007020;font-weight:bold">lambda</span> (x)
    (<span style="color:#007020">*</span> x (<span style="color:#007020">*</span> x x))))

(<span style="color:#007020;font-weight:bold">define</span> cube2
  (<span style="color:#007020;font-weight:bold">lambda</span> (x)
    (<span style="color:#007020">*</span> x x x)))

(<span style="color:#007020;font-weight:bold">define</span> (cube3 x)
  (<span style="color:#007020">*</span> x x x))

(<span style="color:#007020;font-weight:bold">define</span> (pow1 x y)
  (<span style="color:#007020;font-weight:bold">if</span> (=y <span style="color:#40a070">0</span>)
      <span style="color:#40a070">1</span>
      (<span style="color:#007020">*</span> x (pow1 x (<span style="color:#007020">-</span> y <span style="color:#40a070">1</span>)))))

<span style="color:#60a0b0;font-style:italic">; currying</span>
(<span style="color:#007020;font-weight:bold">define</span> pow2
  (<span style="color:#007020;font-weight:bold">lambda</span> (x)
    (<span style="color:#007020;font-weight:bold">lambda</span> (y)
      (pow1 x y))))

</code></pre></div><h3 id="list">List</h3>
<ul>
<li>Empty list: <code>null</code>
<ul>
<li><code>()</code> doesn&quot;t work for <code>null</code> but <code>'()</code> does</li>
</ul>
</li>
<li>build a list: <code>(list e1 ... en)</code></li>
<li>Constructor: <code>cons</code></li>
<li>Access head of list: <code>car</code></li>
<li>Access tail of list: <code>cdr</code></li>
<li>Check for empty: <code>null?</code></li>
</ul>
<h3 id="syntax">Syntax</h3>
<p>A term is either:</p>
<ul>
<li>An atom like <code>#t, #f, 34, &quot;hi&quot;, null, 4.0, x,...</code></li>
<li>A special form like <code>define, lambda, if</code></li>
<li>A sequence of terms in parentheses: <code>(t1 t2 t3)</code></li>
<li>Can use <code>[</code> anything you use <code>(</code></li>
</ul>
<p>Remember parentheses matters! For example:
<code>(e)</code> means call e with 0 argument.</p>
<h3 id="dynamic-typing">Dynamic typing</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define</span> lst (<span style="color:#007020">list</span> <span style="color:#60add5">#t</span> <span style="color:#4070a0">&#34;hi&#34;</span> <span style="color:#40a070">1</span> (<span style="color:#007020">list</span> <span style="color:#40a070">2</span> <span style="color:#40a070">3</span> <span style="color:#40a070">4</span>)))
</code></pre></div><h3 id="cond">Cond</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define</span> (sum3 xs)
  (<span style="color:#007020;font-weight:bold">cond</span> [(<span style="color:#007020">null?</span> xs) <span style="color:#40a070">0</span>]
        [(<span style="color:#007020">number?</span> (<span style="color:#007020">car</span> xs)) (<span style="color:#007020">+</span> (<span style="color:#007020">car</span> xs) (sum3 (<span style="color:#007020">cdr</span> xs)))]
        [<span style="color:#60add5">#t</span> <span style="color:#40a070">0</span>]))
</code></pre></div><h3 id="what-is-true">What is true?</h3>
<p>Anything that is not <code>#f</code> is true <code>#t</code>.</p>
<h3 id="local-bindings">Local bindings</h3>
<h4 id="letletletrec">let/let*/letrec</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">let</span> ([x1 e1]
      [x2 e2]
      <span style="color:#007020;font-weight:bold">...</span>
      [xn en])
  e)
</code></pre></div><p>Racket uses the environment <strong>before</strong> the let-expression to evaluate <code>e1 e2 ... en</code>, which means if <code>en</code> uses <code>x1</code>, <code>x2</code>, that would mean some outer variables of the same name. Instead, the expressions in <code>let*</code> are evaluated in the environment produced from the previous bindings (later ones shadow) .</p>
<p>The expressions in <code>letrec</code> are evaluated in the environment that includes all th bindings. It is needed for mutual recursion.</p>
<h3 id="set">set!</h3>
<p>Racket has assignment statements:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">set!</span> x e)
</code></pre></div><p>Once you have side-effects, sequences are useful:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">begin</span> e1 e2 e3)
</code></pre></div><h3 id="consmcons">cons/mcons</h3>
<p><code>cons</code> produces pairs or lists. (Actually lists are just extented pairs)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define</span> pr (<span style="color:#007020">cons</span> <span style="color:#40a070">1</span> (<span style="color:#007020">cons</span> <span style="color:#60add5">#t</span> <span style="color:#4070a0">&#34;hi&#34;</span>))) <span style="color:#60a0b0;font-style:italic">; is a pair</span>
(<span style="color:#007020;font-weight:bold">define</span> lst (<span style="color:#007020">cons</span> <span style="color:#40a070">1</span> (<span style="color:#007020">cons</span> <span style="color:#60add5">#t</span> (<span style="color:#007020">cons</span> <span style="color:#4070a0">&#34;hi&#34;</span> <span style="color:#007020">null</span>)))) <span style="color:#60a0b0;font-style:italic">; is a list</span>
</code></pre></div><p><code>mcons</code> is another way to make pairs which allows you to change the value inside piars:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define</span> mpr (<span style="color:#007020">mcons</span> <span style="color:#40a070">1</span> (<span style="color:#007020">mcons</span> <span style="color:#60add5">#t</span> <span style="color:#4070a0">&#34;hi&#34;</span>)))
(<span style="color:#007020">mcar</span> mpr) <span style="color:#60a0b0;font-style:italic">; 1</span>
(<span style="color:#007020">mcdr</span> mpr) <span style="color:#60a0b0;font-style:italic">; (mcons (#t &#34;hi&#34;))</span>
(<span style="color:#007020">set-mcdr!</span> mpr <span style="color:#40a070">47</span>) <span style="color:#60a0b0;font-style:italic">; mpr becomes (mcons 1 47)</span>
</code></pre></div><p>Related form:</p>
<ul>
<li><code>mcons</code></li>
<li><code>mcar</code></li>
<li><code>mcdr</code></li>
<li><code>mpair?</code></li>
<li><code>set-mcar!</code></li>
<li><code>set-mcdr!</code></li>
</ul>
<h2 id="delayed-evaluation-and-thunk">Delayed Evaluation and Thunk</h2>
<p>In most programming languages, given <code>e1 e2 ... en</code>, the function arguments <code>e2, ..., en</code> are evaluated once before the function body is executed.
So if we define a function like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#007020;font-weight:bold">define</span> (my-if-bad x y z) (<span style="color:#007020;font-weight:bold">if</span> x y z))

(<span style="color:#007020;font-weight:bold">define</span> (factorial-wrong x)
  (my-if-bad (<span style="color:#007020">=</span> x <span style="color:#40a070">0</span>)
             <span style="color:#40a070">1</span>
             (<span style="color:#007020">*</span> x (factorial-wrong (<span style="color:#007020">-</span> x <span style="color:#40a070">1</span>)))))
</code></pre></div><p>if we use <code>if</code> instead of <code>my-if-bad</code>, <code>factorial-wrong</code> acts just like we want. But with <code>my-if-bad</code>, the function never stops because the two branches evaluate at the same time.</p>
<p>Thanks to lambda, we can delay the evaluation, using the fact that function bodies are not evaluated until the function gets called.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#007020;font-weight:bold">define</span> (my-if x y z) (<span style="color:#007020;font-weight:bold">if</span> x (y) (z)))

(<span style="color:#007020;font-weight:bold">define</span> (factorial x)
  (my-if (<span style="color:#007020">=</span> x <span style="color:#40a070">0</span>)
         (<span style="color:#007020;font-weight:bold">lambda</span> () <span style="color:#40a070">1</span>)
         (<span style="color:#007020;font-weight:bold">lambda</span> () (<span style="color:#007020">*</span> x (factorial (<span style="color:#007020">-</span> x <span style="color:#40a070">1</span>))))))
</code></pre></div><p>The general idiom of using a zero-argument function to delay evaluation is also called a <strong>thunk</strong> (or, thunk the argument).</p>
<p>By the way,</p>
<h2 id="lazy-evaluationcall-by-needpromises">Lazy-evaluation/Call-by-need/Promises</h2>
<h2 id="streams">Streams</h2>
<p>A stream is an infinite sequence of values.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#007020;font-weight:bold">#lang </span><span style="color:#0e84b5;font-weight:bold">racket</span>
<span style="color:#60a0b0;font-style:italic">; 1 1 1 1 ...</span>
(<span style="color:#007020;font-weight:bold">define</span> ones (<span style="color:#007020;font-weight:bold">lambda</span> () (<span style="color:#007020">cons</span> <span style="color:#40a070">1</span> ones)))

<span style="color:#60a0b0;font-style:italic">; 1 2 3 4 ...</span>
(<span style="color:#007020;font-weight:bold">define</span> nats
  (<span style="color:#007020;font-weight:bold">letrec</span> ([f (<span style="color:#007020;font-weight:bold">lambda</span> (x) (<span style="color:#007020">cons</span> x (<span style="color:#007020;font-weight:bold">lambda</span> () (f (<span style="color:#007020">+</span> x <span style="color:#40a070">1</span>)))))])
     (<span style="color:#007020;font-weight:bold">lambda</span> () (f <span style="color:#40a070">1</span>))))

<span style="color:#60a0b0;font-style:italic">; 2 4 6 8 ...</span>
(<span style="color:#007020;font-weight:bold">define</span> power-of-two
  (<span style="color:#007020;font-weight:bold">letrec</span> ([f (<span style="color:#007020;font-weight:bold">lambda</span> (x) (<span style="color:#007020">cons</span> x (<span style="color:#007020;font-weight:bold">lambda</span> () (f (<span style="color:#007020">*</span> x <span style="color:#40a070">2</span>)))))])
    (<span style="color:#007020;font-weight:bold">lambda</span> () (f <span style="color:#40a070">2</span>))))

<span style="color:#60a0b0;font-style:italic">; higher-order maker</span>
(<span style="color:#007020;font-weight:bold">define</span> (stream-maker fn arg)
  (<span style="color:#007020;font-weight:bold">letrec</span> ([f (<span style="color:#007020;font-weight:bold">lambda</span> (x) (<span style="color:#007020">cons</span> x (<span style="color:#007020;font-weight:bold">lambda</span> () (f (fn x arg)))))])
    (<span style="color:#007020;font-weight:bold">lambda</span> () (f arg))))
</code></pre></div><h2 id="memoization-not-memorization">Memoization (Not Memorization)</h2>
<p>Memoization is another idiom related to lazy evaluation that does not actually use thunks. To implement memoization we do use mutation: Whenever the function is called with an argument we have not seen before, we compute the answer and then add the result to the table.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define</span> fibonacci
  (<span style="color:#007020;font-weight:bold">letrec</span>([memo <span style="color:#007020">null</span>]
          [f (<span style="color:#007020;font-weight:bold">lambda</span> (x)
               (<span style="color:#007020;font-weight:bold">let</span> ([ans (<span style="color:#007020">assoc</span> x memo)])
                 (<span style="color:#007020;font-weight:bold">if</span> ans
                     (<span style="color:#007020">cdr</span> ans)
                     (<span style="color:#007020;font-weight:bold">let</span> ([new-ans (<span style="color:#007020;font-weight:bold">if</span> (<span style="color:#007020;font-weight:bold">or</span> (<span style="color:#007020">=</span> x <span style="color:#40a070">1</span>) (<span style="color:#007020">=</span> x <span style="color:#40a070">2</span>))
                                        <span style="color:#40a070">1</span>
                                        (<span style="color:#007020">+</span> (f (<span style="color:#007020">-</span> x <span style="color:#40a070">1</span>))
                                           (f (<span style="color:#007020">-</span> x <span style="color:#40a070">2</span>))))])
                       (<span style="color:#007020;font-weight:bold">begin</span>
                         (<span style="color:#007020;font-weight:bold">set!</span> memo (<span style="color:#007020">cons</span> (<span style="color:#007020">cons</span> x new-ans) memo))
                         new-ans)))))])
    f))
</code></pre></div><h2 id="macros">Macros</h2>
<p>Think about these things about macros and how Racket handles them better than other macro systems(notably C/C++)</p>
<ul>
<li>Tokenization</li>
<li>Parenthesization</li>
<li>Scope</li>
</ul>
<h3 id="syntax-1">Syntax</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">define-syntax</span> myif
  (<span style="color:#007020;font-weight:bold">syntax-rules</span> (then <span style="color:#007020;font-weight:bold">else</span>)
    [(my-if e1 then e2 <span style="color:#007020;font-weight:bold">else</span> e3)
     (<span style="color:#007020;font-weight:bold">if</span> e1 e2 e3)]))

(<span style="color:#007020;font-weight:bold">define-syntax</span> my-delay
  (<span style="color:#007020;font-weight:bold">syntax-rules</span> ()
    [(my-delay e)
     (<span style="color:#007020">mcons</span> <span style="color:#60add5">#f</span> (<span style="color:#007020;font-weight:bold">lambda</span> () e))]))

</code></pre></div><h3 id="hygiene">Hygiene</h3>
<h2 id="recursive-datatypes-via-racketss-struct">Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></h2>
<p><a href="https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29">https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#007020;font-weight:bold">struct</span> foo (bar baz quux) <span style="color:#007020;font-weight:bold">#:transparent</span>
</code></pre></div>
    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basic">Basic</a>
      <ul>
        <li><a href="#list">List</a></li>
        <li><a href="#syntax">Syntax</a></li>
        <li><a href="#dynamic-typing">Dynamic typing</a></li>
        <li><a href="#cond">Cond</a></li>
        <li><a href="#what-is-true">What is true?</a></li>
        <li><a href="#local-bindings">Local bindings</a>
          <ul>
            <li><a href="#letletletrec">let/let*/letrec</a></li>
          </ul>
        </li>
        <li><a href="#set">set!</a></li>
        <li><a href="#consmcons">cons/mcons</a></li>
      </ul>
    </li>
    <li><a href="#delayed-evaluation-and-thunk">Delayed Evaluation and Thunk</a></li>
    <li><a href="#lazy-evaluationcall-by-needpromises">Lazy-evaluation/Call-by-need/Promises</a></li>
    <li><a href="#streams">Streams</a></li>
    <li><a href="#memoization-not-memorization">Memoization (Not Memorization)</a></li>
    <li><a href="#macros">Macros</a>
      <ul>
        <li><a href="#syntax-1">Syntax</a></li>
        <li><a href="#hygiene">Hygiene</a></li>
      </ul>
    </li>
    <li><a href="#recursive-datatypes-via-racketss-struct">Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&text=Racket%20notes" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&is_video=false&description=Racket%20notes" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Racket%20notes&body=Check out this article: https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&name=Racket%20notes&description=Basic%20%23lang%20racket%20%28provide%20%28all-defined-out%29%29%20%3bthis%20is%20a%20comment%20%28define%20s%20%26%2334%3bhello%26%2334%3b%29%20%28define%20x%203%29%20%28define%20y%20%28%2b%20x%202%29%29%20%28define%20cube1%20%28lambda%20%28x%29%20%28%2a%20x%20%28%2a%20x%20x%29%29%29%29%20%28define%20cube2%20%28lambda%20%28x%29%20%28%2a%20x%20x%20x%29%29%29%20%28define%20%28cube3%20x%29%20%28%2a%20x%20x%20x%29%29%20%28define%20%28pow1%20x%20y%29%20%28if%20%28%3dy%200%29%201%20%28%2a%20x%20%28pow1%20x%20%28-%20y%201%29%29%29%29%29%20%3b%20currying%20%28define%20pow2%20%28lambda%20%28x%29%20%28lambda%20%28y%29%20%28pow1%20x%20y%29%29%29%29%20List%20%20Empty%20list%3a%20null%20%20%28%29%20doesn%26quot%3bt%20work%20for%20null%20but%20%27%28%29%20does%20%20%20build%20a%20list%3a%20%28list%20e1%20." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.carldelfin.com%2fposts%2f2020-02-29-racket%2f&t=Racket%20notes" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  Carl Delfin 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
